{
  "type": "object",
  "description": "Create a Concert-Event with bands in one transaction",
  "properties": {
    "event": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the Concert-Event"
        },
        "datetime": {
          "type": "string",
          "pattern": "^\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01]) ([01]\\d|2[0-3]):([0-5]\\d):([0-5]\\d)$",
          "description": "A SQL DATETIME in the format YYYY-MM-DD HH:MM:SS"
        },
        "rating": {
          "type": "integer",
          "description": "Rating of the Event from 0 to 10 (optional)"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes about the Event (optional)"
        }
      },
      "required": ["name", "datetime"]
    },
    "venueId": {
      "type": "integer",
      "description": "Existing Concert-Venue ID"
    },
    "venue": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "address": { "type": "string" },
        "city": { "type": "string" },
        "state": { "type": "string" },
        "country": { "type": "string" },
        "postal_code": { "type": "integer" },
        "type": { "type": "string" },
        "indoor_outdoor": { "type": "string", "enum": ["indoor", "outdoor", "mixed"] },
        "capacity": { "type": "integer" },
        "website": { "type": "string" },
        "notes": { "type": "string" },
        "latitude": { "type": "string" },
        "longitude": { "type": "string" },
        "rating": { "type": "integer" }
      },
      "required": ["name"]
    },
    "bands": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "bandId": { "type": "integer" },
          "band": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "genre": { "type": "string" },
              "origin_country": { "type": "string" },
              "rating": { "type": "integer" },
              "notes": { "type": "string" },
              "link": { "type": "string" },
              "website": { "type": "string" }
            },
            "required": ["name"]
          },
          "setlist": {
            "type": "object",
            "additionalProperties": true
          },
          "rating": { "type": "integer" },
          "mainAct": { "type": "boolean" },
          "runningOrder": { "type": "integer" },
          "notes": { "type": "string" }
        },
        "oneOf": [
          { "required": ["bandId"] },
          { "required": ["band"] }
        ]
      }
    }
  },
  "required": ["event", "bands"],
  "oneOf": [
    { "required": ["venueId"] },
    { "required": ["venue"] }
  ]
}
